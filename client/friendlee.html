<head>
    <title>FriendLee</title>
    <!-- start Mixpanel --><script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==
typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");for(g=0;g<i.length;g++)f(c,i[g]);
b._i.push([a,e,d])};b.__SV=1.2}})(document,window.mixpanel||[]);
mixpanel.init("da76e166658e817e2d9dae5bebeb8cfb");</script><!-- end Mixpanel -->
</head>

<body>
    <div class="container">
        {{> header}}

        {{#if currentUser }}
        {{> search}}

        {{> friendlist}}
        {{> loggingJS}}
        {{else}}
        {{> anonymousIntro}}
        {{/if}}
    </div>
    {{> footer}}
    <script type="text/javascript">
          var _cio = _cio || [];
            (function() {
                var a,b,c;a=function(f){return function(){_cio.push([f].
                    concat(Array.prototype.slice.call(arguments,0)))}};b=["identify",
                        "sidentify","track"];for(c=0;c<b.length;c++){_cio[b[c]]=a(b[c])};
                                var t = document.createElement('script'),
                                        s = document.getElementsByTagName('script')[0];
                                            t.async = true;
                                                t.id    = 'cio-tracker';
                                                    t.setAttribute('data-site-id', 'ddd420424232406d9e5b');
                                                        t.src = 'https://assets.customer.io/assets/track.js';
                                                            s.parentNode.insertBefore(t, s);
                                                              })();
                                                          </script>
</body>


<template name="header">
    <div class="row">
        <div class="span9">
            <h1 class="appTitle animated fadeIn"><i class="icon icon-coffee sec"></i> <span class="title">Friend<span class="sec">Lee</span></span></h1>
        </div>

        <div class="span3">
            {{#if currentUser}}
            {{loginButtons align="right"}}
            {{/if}}
        </div>

    </div>

</template>

<template name="search">

    <div class="row">
        <div class="span12">
            <form class="form-horizontal" id="addfriend">
                <input type="text" id="name" class="span4" autocomplete="off"></input>
                <input type="button" id="addfriendbtn" value="Add Friend" class="btn btn-primary"></input>

            </form>
        </div>
    </div>

</template>



<template name="friendlist">
    <div class="row">
        <div class="friendlist span6">
            {{#each friends}}
                {{> friend}}
                {{else}}
                <p class="none">Add some friends</p>
            {{/each}}
        </div>

        <div class="span6">
            {{#if selected_name}}
            <div class="details animated bounceInDown">
                <div><p><span class="name animated bounce">{{selected_name}}</span> {{#if selected_timeMet}}<br><span class="lastmetmsg">You last met {{selected_timeMet}}{{/if}}</p></div>
                <!-- <p class="form-horizontal"><input type="date" name="dateMet" class="dateMetCal"> <input type="button" class="btn btn-primary met" value="Set date"></p> -->
                <p>
                    <div class="btn-group">
                        <button class="btn btn-primary btn-large metToday"> Met Today</button>
                        <button class="btn btn-primary btn-large  datePickerBtn" data-date="">
                            <i class="icon icon-large icon-calendar"></i> <i class="icon icon-chevron-down"></i></button>

                    </div>
                </p>
                <div>
                    <p> Previous</p>
                    {{#each selected_datesMet}}
                    <p class="previousMeeting">{{this}}</p>
                    {{/each}}
                </div>
                <div>
                    <a class="muted remove"><i class="icon icon-trash"></i> Remove from list</a>
                </div>
            </div>
            {{/if}}

            {{#unless selected_name}}
            <div class="none"><i class="icon icon-arrow-left"></i> Who'd you meet today?</div>
            {{/unless}}
        </div>
    </div>
</template>

<template name="friend">
    <div class="friend {{selected}} row">
        <div class="name span3">{{name}}</div>
        <div class="timeSince">{{timeago}}</div>
    </div>
</template>

<template name="anonymousIntro">
    <div class="anonymousIntro">
        <div class="row">
            <div class="span4">
                {{loginButtons}}
            </div>
            <div class="span6">
                <p class="logincta animated lightSpeedIn"><i class="icon icon-arrow-left"></i> What are you waiting for?</p>
            </div>
        </div>
    </div>

</template>

<template name="footer">
    <footer>
        <div class="container">
            <div class="row">
                <div class="span12">
                    <p>It's 2013! - Made with the best intentions by <a href="http://www.slinlee.com"><i class="icon icon-wrench"></i> Slin Lee</a></p>
                </div>
            </div>
        </div>
    </footer>
    <a href="https://mixpanel.com/f/partner"><img src="//cdn.mxpnl.com/site_media/images/partner/badge_light.png" alt="Mobile Analytics" /></a>
</template>


<template name="loggingJS">
    <script>
        mixpanel.identify(Meteor.userId());
        console.log ("recording id");
        _cio.identify({
            // Required attributes
            id: Meteor.userId(),           // Unique id for the currently signed in user in your application.
            email: '', // Email of the currently signed in user.
            created_on: ''
        });

    </script>

</template>

